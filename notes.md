# Реализация простого сервиса голосования

## Возможности
- Позволяет добавлять информацию о кандидате
* Id, имя и информация о кандидате
- Позволяет добавлять информацию о голосующем человеке
* Id и имя
- Позволяет добавлять голос за кандидата
* После получения голос шифруется и сохраняется
- Позволяет получать итоги голосования
* Итоги можно получить как в зашифрованном, так и в открытом виде
- Позволяет получить номер блока по id голосующего

## Важно
В ходе имплементации была допущена ошибка: шифрование было реализовано не для транзакций с голосами, а для голосов, которые сохраняются в схеме,
поэтому голосование так и осталось не анонимным.

В данной реализации шифрование осуществлено по следующей схеме: нода получает публичный ключ автора/администратора голосования (через файл конфигурации).
Этот ключ и приватный ключ сервиса используются для создания эфемерного ключа, которым сервис кодирует полученные голоса.
При запросе зашифрованых результатов сервис возвращает зашифрованные результаты и свой публичный ключ. Автор голосования с помощью этого ключа и своего приватного ключа получает эфемерный ключ для декодирования результатов.
При запросе расшифрованых результатов сервис использует полученный ранее эфемерный ключ для декодирования голосов, после чего возвращает результаты в открытом виде.

Для реализации шифрования использовалась бибилиотека `ring`:
- Для получения эфемерных ключей используется X25519
- В качестве алгоритма шифрования используется ChaCha20

## Структура проекта
Доступ к документации можно получить через cargo doc.

### agreement.rs
Данный файл является оберткой над функционалом ring::agreement для получения эфемерных ключей.

### api.rs
В данном файле находится реализация REST API для сервиса.

### cipher.rs
Обертка над функционалом ring::aead для шифрования. Предоставляет функции encrypt_vote и decrypt_vote для шифрования и дешифрования голосов.

### config.rs
Здесь описана структура конфигурации для сервиса.

### contracts.rs
Реализация транзакций для создания кандидата и голосующего, а также для добавления голоса.

### errors.rs
Описание ошибок, которые могут возникнуть во время выполнения транзакций.

### lib.rs
Содержит реализацию сервиса и фабрики для создания сервиса и конфигурации.

### schema.rs
Реализация доступа к данным в схеме, описание структур, которые хранятся в схеме.

### transactions.rs
Описание транзакций для сервиса (добавление кандидата, голосующего и голоса).

### tests/mod.rs
Тесты и вспомогательные функции для тестов.